
						EJERCICIO BLOC DE NOTAS (BASE DE DATOS DISTRIBUIDAS)

CREATE USER ADMINISTRADOR10 IDENTIFIED BY ADMIN123;

GRANT CONNECT, RESOURCE, UNLIMITED TABLESPACE, CREATE ANY VIEW TO ADMINISTRADOR10;

CREATE USER CAMPUS_HUACHI IDENTIFIED BY HUACHI;

GRANT CONNECT, RESOURCE, UNLIMITED TABLESPACE TO CAMPUS_HUACHI;

CREATE USER CAMPUS_INGAHURCO IDENTIFIED BY INGAHURCO;

GRANT CONNECT, RESOURCE, UNLIMITED TABLESPACE TO CAMPUS_INGAHURCO;

CREATE USER CAMPUS_QUEROCHACA IDENTIFIED BY QUEROCHACA;

GRANT CONNECT, RESOURCE, UNLIMITED TABLESPACE TO CAMPUS_QUEROCHACA;

--------------------------

GRANT SELECT, INSERT, UPDATE, DELETE ON CAMPUS_HUACHI.CAMPUS_HUACHI_CARRERAS TO ADMINISTRADOR10;

GRANT SELECT, INSERT, UPDATE, DELETE ON CAMPUS_INGAHURCO.CAMPUS_INGAHURCO_CARRERAS TO ADMINISTRADOR10;

GRANT SELECT, INSERT, UPDATE, DELETE ON CAMPUS_QUEROCHACA.CAMPUS_QUEROCHACA_CARRERAS TO ADMINISTRADOR10;


----------

CREATE TABLE CAMPUS_HUACHI_CARRERAS 
(ID_CAR NUMBER PRIMARY KEY,
 NOM_CAR VARCHAR(50) NOT NULL,
 MOD_CAR VARCHAR(30) NOT NULL,
 CANT_CUP NUMBER NOT NULL,
 CAMPUS_PER VARCHAR(30) NOT NULL);

CREATE TABLE CAMPUS_INGAHURCO_CARRERAS 
(ID_CAR NUMBER PRIMARY KEY,
 NOM_CAR VARCHAR(50) NOT NULL,
 MOD_CAR VARCHAR(30) NOT NULL,
 CANT_CUP NUMBER NOT NULL,
 CAMPUS_PER VARCHAR(30) NOT NULL);

CREATE TABLE CAMPUS_QUEROCHACA_CARRERAS 
(ID_CAR NUMBER PRIMARY KEY,
 NOM_CAR VARCHAR(50) NOT NULL,
 MOD_CAR VARCHAR(30) NOT NULL,
 CANT_CUP NUMBER NOT NULL,
 CAMPUS_PER VARCHAR(30) NOT NULL);


---------------------------------

CREATE OR REPLACE VIEW VISTA_GLOBAL AS
   SELECT * FROM CAMPUS_HUACHI.CAMPUS_HUACHI_CARRERAS
   UNION ALL
   SELECT * FROM CAMPUS_INGAHURCO.CAMPUS_INGAHURCO_CARRERAS
   UNION ALL
   SELECT * FROM CAMPUS_QUEROCHACA.CAMPUS_QUEROCHACA_CARRERAS;


CREATE OR REPLACE TRIGGER INSERTAR_CARRERA
INSTEAD OF INSERT ON VISTA_GLOBAL
FOR EACH ROW
BEGIN
   IF UPPER(:NEW.CAMPUS_PER) = 'HUACHI' THEN
      INSERT INTO CAMPUS_HUACHI.CAMPUS_HUACHI_CARRERAS
      VALUES (:NEW.ID_CAR, :NEW.NOM_CAR, :NEW.MOD_CAR, :NEW.CANT_CUP, :NEW.CAMPUS_PER);

   ELSIF UPPER(:NEW.CAMPUS_PER) = 'INGAHURCO' THEN
      INSERT INTO CAMPUS_INGAHURCO.CAMPUS_INGAHURCO_CARRERAS
      VALUES (:NEW.ID_CAR, :NEW.NOM_CAR, :NEW.MOD_CAR, :NEW.CANT_CUP, :NEW.CAMPUS_PER);

   ELSIF UPPER(:NEW.CAMPUS_PER) = 'QUEROCHACA' THEN
      INSERT INTO CAMPUS_QUEROCHACA.CAMPUS_QUEROCHACA_CARRERAS
      VALUES (:NEW.ID_CAR, :NEW.NOM_CAR, :NEW.MOD_CAR, :NEW.CANT_CUP, :NEW.CAMPUS_PER);
   END IF;
END INSERTAR_CARRERA;
.
/

CREATE SEQUENCE SEQ_ID_CAR;

INSERT INTO VISTA_GLOBAL
VALUES (SEQ_ID_CAR.NEXTVAL,'INGENIERIA EN SISTEMAS','PRESENCIAL',50,'HUACHI');

-----------------------------------

EJEMPLOS:

INSERT INTO VISTA_GLOBAL
VALUES (SEQ_ID_CAR.NEXTVAL,'INGENIERIA EN SOFTWARE','PRESENCIAL',40,'HUACHI');

INSERT INTO VISTA_GLOBAL
VALUES (SEQ_ID_CAR.NEXTVAL,'INGENIERIA EN TELECOMUNICACIONES','PRESENCIAL',70,'HUACHI');

INSERT INTO VISTA_GLOBAL
VALUES (SEQ_ID_CAR.NEXTVAL,'MEDICINA','PRESENCIAL',30,'INGAHURCO');

INSERT INTO VISTA_GLOBAL
VALUES (SEQ_ID_CAR.NEXTVAL,'ENFERMERIA','PRESENCIAL',40,'INGAHURCO');

INSERT INTO VISTA_GLOBAL
VALUES (SEQ_ID_CAR.NEXTVAL,'AUXILIAR EN ENFERMERIA','PRESENCIAL',60,'INGAHURCO');

INSERT INTO VISTA_GLOBAL
VALUES (SEQ_ID_CAR.NEXTVAL,'AGRONOMIA','PRESENCIAL',80,'QUEROCHACA');

INSERT INTO VISTA_GLOBAL
VALUES (SEQ_ID_CAR.NEXTVAL,'VETERINARIA','PRESENCIAL',17,'QUEROCHACA');

INSERT INTO VISTA_GLOBAL
VALUES (SEQ_ID_CAR.NEXTVAL,'BIOTECNOLOGIA','PRESENCIAL',57,'QUEROCHACA');

